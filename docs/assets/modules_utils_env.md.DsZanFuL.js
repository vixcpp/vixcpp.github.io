import{_ as s,o as e,c as a,a as t}from"./app.C-Y5xfQj.js";import"./chunks/markjs.l6TISjdC.js";import"./chunks/minisearch.DigTKvvb.js";const E=JSON.parse('{"title":"Env utilities","description":"","frontmatter":{},"headers":[],"relativePath":"modules/utils/env.md","filePath":"modules/utils/env.md","lastUpdated":1770827001000}'),l={name:"modules/utils/env.md"};function n(h,i,d,p,o,k){return e(),a("div",null,[...i[0]||(i[0]=[t('<h1 id="env-utilities" tabindex="-1">Env utilities <a class="header-anchor" href="#env-utilities" aria-label="Permalink to &quot;Env utilities&quot;">​</a></h1><p>Header: <code>vix/utils/Env.hpp</code></p><p>This module provides small helpers to read environment variables and convert them into useful types (<code>std::string</code>, <code>bool</code>, <code>int</code>, <code>unsigned</code>, <code>double</code>).</p><p>Goals:</p><ul><li>Header only</li><li>No exceptions</li><li>Safe defaults (missing or invalid values return the provided default)</li><li>Whitespace tolerant (leading and trailing spaces are ignored)</li><li>ASCII only case insensitive parsing for booleans</li></ul><h2 id="api" tabindex="-1">API <a class="header-anchor" href="#api" aria-label="Permalink to &quot;API&quot;">​</a></h2><h3 id="env-or-key-def" tabindex="-1"><code>env_or(key, def)</code> <a class="header-anchor" href="#env-or-key-def" aria-label="Permalink to &quot;`env_or(key, def)`&quot;">​</a></h3><p>Returns the variable value as a <code>std::string</code>, or <code>def</code> if missing.</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::string host </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;APP_HOST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="env-bool-key-def" tabindex="-1"><code>env_bool(key, def)</code> <a class="header-anchor" href="#env-bool-key-def" aria-label="Permalink to &quot;`env_bool(key, def)`&quot;">​</a></h3><p>Reads a variable as boolean.</p><p>Truthy values (case insensitive):</p><ul><li><code>1</code></li><li><code>true</code></li><li><code>yes</code></li><li><code>on</code></li></ul><p>Everything else is false. Missing key returns <code>def</code>.</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VIX_COLOR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="env-int-key-def" tabindex="-1"><code>env_int(key, def)</code> <a class="header-anchor" href="#env-int-key-def" aria-label="Permalink to &quot;`env_int(key, def)`&quot;">​</a></h3><p>Reads a signed integer in base 10 using <code>std::from_chars</code>.</p><ul><li>Trims whitespace</li><li>Requires the full string to be parsed (no trailing garbage)</li></ul><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> port </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PORT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="env-uint-key-def" tabindex="-1"><code>env_uint(key, def)</code> <a class="header-anchor" href="#env-uint-key-def" aria-label="Permalink to &quot;`env_uint(key, def)`&quot;">​</a></h3><p>Reads an unsigned integer in base 10 using <code>std::from_chars</code>.</p><ul><li>Trims whitespace</li><li>Requires full parse</li></ul><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">unsigned</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> threads </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_uint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WORKERS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="env-double-key-def" tabindex="-1"><code>env_double(key, def)</code> <a class="header-anchor" href="#env-double-key-def" aria-label="Permalink to &quot;`env_double(key, def)`&quot;">​</a></h3><p>Reads a <code>double</code> using <code>std::strtod</code>.</p><ul><li>Trims whitespace</li><li>Requires full parse</li><li>Uses <code>.</code> as decimal separator</li></ul><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ratio </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CACHE_RATIO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="platform-notes" tabindex="-1">Platform notes <a class="header-anchor" href="#platform-notes" aria-label="Permalink to &quot;Platform notes&quot;">​</a></h2><h3 id="vix-getenv-name" tabindex="-1"><code>vix_getenv(name)</code> <a class="header-anchor" href="#vix-getenv-name" aria-label="Permalink to &quot;`vix_getenv(name)`&quot;">​</a></h3><p>Internally, the helpers call <code>vix_getenv</code>.</p><ul><li>POSIX: uses <code>std::getenv(name)</code>.</li><li>Windows: uses <code>_dupenv_s</code> and stores the value in a <code>thread_local std::string</code>. <ul><li>This avoids returning pointers to freed memory.</li><li>The returned <code>const char*</code> remains valid until the next <code>vix_getenv</code> call on the same thread.</li></ul></li></ul><p>Practical rule: if you need to keep the value, copy it (all public helpers already return by value).</p><h2 id="behavior-details" tabindex="-1">Behavior details <a class="header-anchor" href="#behavior-details" aria-label="Permalink to &quot;Behavior details&quot;">​</a></h2><ul><li>Missing variable: returns the default.</li><li>Empty value: <ul><li><code>env_or</code> returns an empty string (unless you passed a non empty default).</li><li><code>env_bool</code> treats empty as false. If you want empty to behave like default, do not export the variable at all.</li><li><code>env_int</code> and <code>env_uint</code> return <code>def</code>.</li><li><code>env_double</code> returns <code>def</code>.</li></ul></li><li>Invalid numeric values (non digits, overflow, trailing characters): return <code>def</code>.</li></ul><h2 id="example-patterns" tabindex="-1">Example patterns <a class="header-anchor" href="#example-patterns" aria-label="Permalink to &quot;Example patterns&quot;">​</a></h2><h3 id="feature-flags" tabindex="-1">Feature flags <a class="header-anchor" href="#feature-flags" aria-label="Permalink to &quot;Feature flags&quot;">​</a></h3><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> enable_metrics </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VIX_METRICS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="limits" tabindex="-1">Limits <a class="header-anchor" href="#limits" aria-label="Permalink to &quot;Limits&quot;">​</a></h3><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> unsigned</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> max_conns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_uint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VIX_MAX_CONNS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="config-selection" tabindex="-1">Config selection <a class="header-anchor" href="#config-selection" aria-label="Permalink to &quot;Config selection&quot;">​</a></h3><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::string config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">utils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env_or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VIX_CONFIG&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;config.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="common-variables-used-in-vix-runtime" tabindex="-1">Common variables used in Vix runtime <a class="header-anchor" href="#common-variables-used-in-vix-runtime" aria-label="Permalink to &quot;Common variables used in Vix runtime&quot;">​</a></h2><p>These names are not required by the Env module, but they are commonly used by other Vix components.</p><ul><li><code>NO_COLOR</code>: disable colors when set to any non empty value.</li><li><code>VIX_COLOR</code>: override coloring, values like <code>never</code>, <code>0</code>, <code>false</code>, <code>always</code>, <code>1</code>, <code>true</code>.</li><li><code>VIX_MODE</code>: values like <code>dev</code>, <code>watch</code>, <code>reload</code> map to dev mode, others map to run.</li><li><code>VIX_NO_HYPERLINK</code>: disable terminal hyperlinks when set.</li><li><code>VIX_NO_ANIM</code>: disable small banner animations when set.</li></ul>',44)])])}const g=s(l,[["render",n]]);export{E as __pageData,g as default};
