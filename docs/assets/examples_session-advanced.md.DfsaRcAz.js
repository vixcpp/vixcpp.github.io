import{_ as s,o as a,c as e,a as t}from"./app.CA4BvVBe.js";import"./chunks/markjs.l6TISjdC.js";import"./chunks/minisearch.DigTKvvb.js";const g=JSON.parse('{"title":"Advanced Security Section --- Sessions & JWT","description":"","frontmatter":{},"headers":[],"relativePath":"examples/session-advanced.md","filePath":"examples/session-advanced.md","lastUpdated":1771331966000}'),n={name:"examples/session-advanced.md"};function l(p,i,r,h,o,k){return a(),e("div",null,[...i[0]||(i[0]=[t(`<h1 id="advanced-security-section-sessions-jwt" tabindex="-1">Advanced Security Section --- Sessions &amp; JWT <a class="header-anchor" href="#advanced-security-section-sessions-jwt" aria-label="Permalink to &quot;Advanced Security Section --- Sessions &amp; JWT&quot;">‚Äã</a></h1><p>This guide expands on advanced security considerations for <strong>Session-based</strong> and <strong>JWT-based</strong> authentication.</p><p>This is for developers building real production systems.</p><h1 id="_1Ô∏è‚É£-transport-security-mandatory" tabindex="-1">1Ô∏è‚É£ Transport Security (MANDATORY) <a class="header-anchor" href="#_1Ô∏è‚É£-transport-security-mandatory" aria-label="Permalink to &quot;1Ô∏è‚É£ Transport Security (MANDATORY)&quot;">‚Äã</a></h1><h2 id="always-use-https" tabindex="-1">Always use HTTPS <a class="header-anchor" href="#always-use-https" aria-label="Permalink to &quot;Always use HTTPS&quot;">‚Äã</a></h2><p>Without HTTPS:</p><ul><li>Cookies can be intercepted</li><li>JWT tokens can be stolen</li><li>Session IDs can be hijacked</li></ul><p>In production:</p><ul><li>Enable TLS</li><li>Set Secure cookies</li><li>Use HSTS</li></ul><p>Example (session strict preset):</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">middleware</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session_strict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;strong_secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div><h1 id="_2Ô∏è‚É£-cookie-security-session" tabindex="-1">2Ô∏è‚É£ Cookie Security (Session) <a class="header-anchor" href="#_2Ô∏è‚É£-cookie-security-session" aria-label="Permalink to &quot;2Ô∏è‚É£ Cookie Security (Session)&quot;">‚Äã</a></h1><p>When using Sessions:</p><h2 id="enable" tabindex="-1">Enable: <a class="header-anchor" href="#enable" aria-label="Permalink to &quot;Enable:&quot;">‚Äã</a></h2><ul><li>HttpOnly ‚Üí prevents JS access</li><li>Secure ‚Üí HTTPS only</li><li>SameSite ‚Üí Lax or Strict</li></ul><p>Example:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">middleware</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session_dev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;sid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chrono</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hours</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // secure</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;Strict&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // same_site</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // http_only</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="protect-against" tabindex="-1">Protect Against: <a class="header-anchor" href="#protect-against" aria-label="Permalink to &quot;Protect Against:&quot;">‚Äã</a></h2><ul><li>XSS</li><li>CSRF</li><li>Session fixation</li></ul><h1 id="_3Ô∏è‚É£-csrf-protection-session" tabindex="-1">3Ô∏è‚É£ CSRF Protection (Session) <a class="header-anchor" href="#_3Ô∏è‚É£-csrf-protection-session" aria-label="Permalink to &quot;3Ô∏è‚É£ CSRF Protection (Session)&quot;">‚Äã</a></h1><p>Sessions are vulnerable to CSRF.</p><p>Use CSRF middleware:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">middleware</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">csrf_dev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span></code></pre></div><p>Why?</p><p>Because browsers automatically send cookies.</p><p>JWT (in Authorization header) is less vulnerable to CSRF.</p><h1 id="_4Ô∏è‚É£-jwt-security-best-practices" tabindex="-1">4Ô∏è‚É£ JWT Security Best Practices <a class="header-anchor" href="#_4Ô∏è‚É£-jwt-security-best-practices" aria-label="Permalink to &quot;4Ô∏è‚É£ JWT Security Best Practices&quot;">‚Äã</a></h1><h2 id="use-strong-secret" tabindex="-1">Use Strong Secret <a class="header-anchor" href="#use-strong-secret" aria-label="Permalink to &quot;Use Strong Secret&quot;">‚Äã</a></h2><p>Do NOT use:</p><p>&quot;dev&quot; &quot;1234&quot; &quot;secret&quot;</p><p>Use:</p><ul><li>256-bit random secret</li><li>Or environment variable</li></ul><h2 id="set-expiration" tabindex="-1">Set Expiration <a class="header-anchor" href="#set-expiration" aria-label="Permalink to &quot;Set Expiration&quot;">‚Äã</a></h2><p>Always set:</p><ul><li>exp claim</li><li>Short TTL for access tokens</li></ul><p>Enable expiration verification:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">middleware</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jwt_dev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="avoid-storing-jwt-in-localstorage" tabindex="-1">Avoid Storing JWT in LocalStorage <a class="header-anchor" href="#avoid-storing-jwt-in-localstorage" aria-label="Permalink to &quot;Avoid Storing JWT in LocalStorage&quot;">‚Äã</a></h2><p>Why?</p><p>LocalStorage is accessible to JavaScript. If XSS occurs ‚Üí token stolen.</p><p>Safer option:</p><ul><li>Store JWT in HttpOnly Secure cookie</li><li>Or use short-lived tokens</li></ul><h1 id="_5Ô∏è‚É£-token-revocation-strategy" tabindex="-1">5Ô∏è‚É£ Token Revocation Strategy <a class="header-anchor" href="#_5Ô∏è‚É£-token-revocation-strategy" aria-label="Permalink to &quot;5Ô∏è‚É£ Token Revocation Strategy&quot;">‚Äã</a></h1><p>JWT problem:</p><p>You cannot easily revoke tokens.</p><p>Solutions:</p><ul><li>Short expiration (15 min)</li><li>Refresh tokens</li><li>Blacklist storage</li><li>Rotate signing keys</li></ul><h1 id="_6Ô∏è‚É£-session-storage-hardening" tabindex="-1">6Ô∏è‚É£ Session Storage Hardening <a class="header-anchor" href="#_6Ô∏è‚É£-session-storage-hardening" aria-label="Permalink to &quot;6Ô∏è‚É£ Session Storage Hardening&quot;">‚Äã</a></h1><p>If using sessions at scale:</p><ul><li>Use Redis</li><li>Use expiration</li><li>Limit session size</li><li>Rotate session ID on login</li></ul><p>Prevent session fixation:</p><p>Generate new session ID after authentication.</p><h1 id="_7Ô∏è‚É£-rbac-hardening" tabindex="-1">7Ô∏è‚É£ RBAC Hardening <a class="header-anchor" href="#_7Ô∏è‚É£-rbac-hardening" aria-label="Permalink to &quot;7Ô∏è‚É£ RBAC Hardening&quot;">‚Äã</a></h1><p>Never trust client roles.</p><p>Always verify on server:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">require_role</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">require_perm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;products:write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Never rely only on frontend checks.</p><h1 id="_8Ô∏è‚É£-rate-limiting-auth" tabindex="-1">8Ô∏è‚É£ Rate Limiting + Auth <a class="header-anchor" href="#_8Ô∏è‚É£-rate-limiting-auth" aria-label="Permalink to &quot;8Ô∏è‚É£ Rate Limiting + Auth&quot;">‚Äã</a></h1><p>Protect authentication endpoints:</p><ul><li>Rate limit login</li><li>Rate limit token generation</li></ul><p>Example:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">middleware</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rate_limit_dev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div><h1 id="_9Ô∏è‚É£-defense-in-depth" tabindex="-1">9Ô∏è‚É£ Defense in Depth <a class="header-anchor" href="#_9Ô∏è‚É£-defense-in-depth" aria-label="Permalink to &quot;9Ô∏è‚É£ Defense in Depth&quot;">‚Äã</a></h1><p>Combine:</p><ul><li>HTTPS</li><li>Security headers</li><li>CSRF</li><li>Rate limit</li><li>RBAC</li><li>Logging</li><li>Monitoring</li></ul><p>Security is layered.</p><h1 id="üîü-production-checklist" tabindex="-1">üîü Production Checklist <a class="header-anchor" href="#üîü-production-checklist" aria-label="Permalink to &quot;üîü Production Checklist&quot;">‚Äã</a></h1><p>For Sessions:</p><ul><li>HTTPS</li><li>Secure + HttpOnly</li><li>SameSite configured</li><li>CSRF enabled</li><li>Session TTL</li><li>Session ID rotation</li></ul><p>For JWT:</p><ul><li>Strong secret</li><li>exp enabled</li><li>verify_exp = true</li><li>Short TTL</li><li>Secure storage</li><li>RBAC enforcement</li></ul><h1 id="final-advice" tabindex="-1">Final Advice <a class="header-anchor" href="#final-advice" aria-label="Permalink to &quot;Final Advice&quot;">‚Äã</a></h1><p>Authentication is not just middleware.</p><p>It is:</p><ul><li>Transport security</li><li>Storage security</li><li>Token lifecycle management</li><li>Authorization enforcement</li><li>Monitoring and logging</li></ul><p>Build systems assuming attackers exist.</p><p>Security is architecture, not configuration.</p>`,77)])])}const E=s(n,[["render",l]]);export{g as __pageData,E as default};
