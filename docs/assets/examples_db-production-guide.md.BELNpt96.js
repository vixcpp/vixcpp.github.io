import{_ as s,o as a,c as e,a as t}from"./app.OIXPjicE.js";import"./chunks/markjs.l6TISjdC.js";import"./chunks/minisearch.DigTKvvb.js";const u=JSON.parse('{"title":"Vix DB Production Guide","description":"","frontmatter":{},"headers":[],"relativePath":"examples/db-production-guide.md","filePath":"examples/db-production-guide.md","lastUpdated":1771331966000}'),n={name:"examples/db-production-guide.md"};function l(p,i,r,o,h,d){return a(),e("div",null,[...i[0]||(i[0]=[t(`<h1 id="vix-db-production-guide" tabindex="-1">Vix DB Production Guide <a class="header-anchor" href="#vix-db-production-guide" aria-label="Permalink to &quot;Vix DB Production Guide&quot;">​</a></h1><p>This guide explains how to use the Vix C++ DB module safely in production environments.</p><p>It focuses on:</p><ul><li>Connection pooling strategy</li><li>Transactions best practices</li><li>Error handling</li><li>Migrations strategy</li><li>Performance recommendations</li><li>Security considerations</li></ul><h1 id="_1-connection-pooling-strategy" tabindex="-1">1. Connection Pooling Strategy <a class="header-anchor" href="#_1-connection-pooling-strategy" aria-label="Permalink to &quot;1. Connection Pooling Strategy&quot;">​</a></h1><h2 id="recommended-settings" tabindex="-1">Recommended Settings <a class="header-anchor" href="#recommended-settings" aria-label="Permalink to &quot;Recommended Settings&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cfg.mysql.pool.min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cfg.mysql.pool.max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Guidelines:</p><ul><li>Small apps: 2--4 connections</li><li>Medium apps: 8--16 connections</li><li>High traffic APIs: tune based on load testing</li></ul><p>Why pooling matters:</p><ul><li>Avoids connection creation overhead</li><li>Improves latency</li><li>Reduces database stress</li></ul><p>Never create Database per request. Create it once at application startup.</p><h1 id="_2-transaction-best-practices" tabindex="-1">2. Transaction Best Practices <a class="header-anchor" href="#_2-transaction-best-practices" aria-label="Permalink to &quot;2. Transaction Best Practices&quot;">​</a></h1><p>Always use RAII transactions:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Transaction</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// work</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><p>Rules:</p><ul><li>Keep transactions short</li><li>Do not perform network calls inside transactions</li><li>Commit explicitly</li><li>Let rollback happen automatically on exceptions</li></ul><h1 id="_3-error-handling" tabindex="-1">3. Error Handling <a class="header-anchor" href="#_3-error-handling" aria-label="Permalink to &quot;3. Error Handling&quot;">​</a></h1><p>Always wrap DB logic in try/catch:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Transaction </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // DB logic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::exception</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    log_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">what</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Never expose raw DB errors to HTTP clients.</p><h1 id="_4-migrations-in-production" tabindex="-1">4. Migrations in Production <a class="header-anchor" href="#_4-migrations-in-production" aria-label="Permalink to &quot;4. Migrations in Production&quot;">​</a></h1><p>Strategy:</p><ul><li>Use versioned migrations</li><li>Never modify old migrations</li><li>Always add new migration files</li></ul><p>Recommended flow:</p><ol><li>Deploy code</li><li>Run migrations</li><li>Restart services if needed</li></ol><p>Keep migrations idempotent.</p><h1 id="_5-performance-optimization" tabindex="-1">5. Performance Optimization <a class="header-anchor" href="#_5-performance-optimization" aria-label="Permalink to &quot;5. Performance Optimization&quot;">​</a></h1><p>Use prepared statements everywhere.</p><p>Bad:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM users WHERE id = &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id</span></span></code></pre></div><p>Good:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">st-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, id);</span></span></code></pre></div><p>Add proper DB indexes:</p><ul><li>Index foreign keys</li><li>Index frequently filtered columns</li><li>Avoid over-indexing</li></ul><p>Measure before optimizing.</p><h1 id="_6-security-best-practices" tabindex="-1">6. Security Best Practices <a class="header-anchor" href="#_6-security-best-practices" aria-label="Permalink to &quot;6. Security Best Practices&quot;">​</a></h1><ul><li>Never store plaintext passwords</li><li>Use environment variables for DB credentials</li><li>Limit DB user privileges</li><li>Use TLS connections in production</li><li>Rotate credentials periodically</li></ul><h1 id="_7-deployment-checklist" tabindex="-1">7. Deployment Checklist <a class="header-anchor" href="#_7-deployment-checklist" aria-label="Permalink to &quot;7. Deployment Checklist&quot;">​</a></h1><p>Before production:</p><ul><li>Pool size tuned</li><li>Indexes verified</li><li>Migrations tested</li><li>Error logging enabled</li><li>Backups configured</li><li>Monitoring enabled</li></ul><h1 id="final-advice" tabindex="-1">Final Advice <a class="header-anchor" href="#final-advice" aria-label="Permalink to &quot;Final Advice&quot;">​</a></h1><p>Database is critical infrastructure.</p><p>Treat it as:</p><ul><li>Stateful</li><li>Sensitive</li><li>Performance-critical</li></ul><p>Design carefully. Test under load. Monitor continuously.</p><p>Vix DB gives you control. Production reliability depends on your discipline.</p>`,47)])])}const E=s(n,[["render",l]]);export{u as __pageData,E as default};
